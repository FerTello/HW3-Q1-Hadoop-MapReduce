{"version":"NotebookV1","origId":1299585061269602,"name":"q2-skeleton","language":"scala","commands":[{"version":"CommandV1","origId":1299585061269605,"guid":"09d66e26-6cf1-4107-af2d-d38e55877f26","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n#### Q2 - Skeleton Scala Notebook\nThis template Scala Notebook is provided to provide a basic setup for reading in / writing out the graph file and help you get started with Scala.  Clicking 'Run All' above will execute all commands in the notebook and output a file 'toygraph.csv'.  See assignment instructions on how to to retrieve this file. You may modify the notebook below the 'Cmd2' block as necessary.\n\n#### Precedence of Instruction\nThe examples provided herein are intended to be more didactic in nature to get you up to speed w/ Scala.  However, should the HW assignment instructions diverge from the content in this notebook, by incident of revision or otherwise, the HW assignment instructions shall always take precedence.  Do not rely solely on the instructions within this notebook as the final authority of the requisite deliverables prior to submitting this assignment.  Usage of this notebook implicitly guarantees that you understand the risks of using this template code. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1538639007691,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"matthewhull@gatech.edu","latestUserId":"8931426928977113","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8325687f-719f-4230-86a3-dc1e6d37bf2a"},{"version":"CommandV1","origId":1299585061269606,"guid":"6cce7b0f-08bd-42c4-ad50-fb0f2c50ae4c","subtype":"command","commandType":"auto","position":1.0,"command":"/*\nDO NOT MODIFY THIS BLOCK\nThis assignment can be completely accomplished with the following includes and case class.\nDo not modify the %language prefixes, only use Scala code within this notebook.  The auto-grader will check for instances of <%some-other-lang>, e.g., %python\n*/\nimport org.apache.spark.sql.functions.desc\nimport org.apache.spark.sql.functions._\ncase class edges(Source: String, Target: String, Weight: Int)\nimport spark.implicits._","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.desc\nimport org.apache.spark.sql.functions._\ndefined class edges\nimport spark.implicits._\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1538639007723,"submitTime":1538639007699,"finishTime":1538639010025,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"matthewhull@gatech.edu","latestUserId":"8931426928977113","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"936559d5-3bba-4279-acd0-6e8bbf881965"},{"version":"CommandV1","origId":1299585061269607,"guid":"08a77e10-e452-42f7-843b-3e96e22599ce","subtype":"command","commandType":"auto","position":1.25,"command":"/* \nCreate an RDD of graph objects from our toygraph.csv file, convert it to a Dataframe\nReplace the 'toygraph.csv' below with the name of Q2 graph file.\n*/\n\nval df = spark.read.textFile(\"/FileStore/tables/toygraph.csv\") \n  .map(_.split(\",\"))\n  .map(columns => edges(columns(0), columns(1), columns(2).toInt)).toDF()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">df: org.apache.spark.sql.DataFrame = [Source: string, Target: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"Source","type":"string","nullable":true,"metadata":{}},{"name":"Target","type":"string","nullable":true,"metadata":{}},{"name":"Weight","type":"integer","nullable":false,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1538639010030,"submitTime":1538639007701,"finishTime":1538639011246,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"matthewhull@gatech.edu","latestUserId":"8931426928977113","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"61bd0416-a84d-4dba-8e4a-9365b693b00b"},{"version":"CommandV1","origId":1299585061269608,"guid":"2cb03e73-b407-4581-a84a-497e416d1256","subtype":"command","commandType":"auto","position":1.625,"command":"// Insert blocks as needed to further process your graph, the division and number of code blocks is at your discretion.","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1538639011251,"submitTime":1538639007703,"finishTime":1538639011345,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"matthewhull@gatech.edu","latestUserId":"8931426928977113","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9f598021-14fb-4732-8af7-407d57a84acf"},{"version":"CommandV1","origId":1299585061269609,"guid":"4b6d6ef3-5eaf-4279-b000-1d04754abe5d","subtype":"command","commandType":"auto","position":1.8125,"command":"// e.g. eliminate duplicate rows","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1538639011348,"submitTime":1538639007705,"finishTime":1538639011445,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"matthewhull@gatech.edu","latestUserId":"8931426928977113","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"af9f2689-6a19-4479-8da2-90ed988c2d33"},{"version":"CommandV1","origId":1299585061269610,"guid":"30b52a16-e62a-4eca-a2b9-31576edff04a","subtype":"command","commandType":"auto","position":1.90625,"command":"// e.g. filter nodes by edge weight >= supplied threshold in assignment instructions","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1538639011448,"submitTime":1538639007707,"finishTime":1538639011544,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"matthewhull@gatech.edu","latestUserId":"8931426928977113","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5c18444b-13cd-48b9-8af2-5935a318b2f8"},{"version":"CommandV1","origId":1299585061269611,"guid":"6284d208-b3d6-444a-9abb-2bffd4c40506","subtype":"command","commandType":"auto","position":1.953125,"command":"// find node with highest in-degree, if two or more nodes have the same in-degree, report the one with the lowest node id\n// find node with highest out-degree, if two or more nodes have the same out-degree, report the one with the lowest node id\n// find node with highest total degree, if two or more nodes have the same total degree, report the one with the lowest node id","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1538639011549,"submitTime":1538639007709,"finishTime":1538639011646,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"matthewhull@gatech.edu","latestUserId":"8931426928977113","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"71dfc964-7c4c-4584-a0ee-3958b17dca9b"},{"version":"CommandV1","origId":1299585061269612,"guid":"42a5ab60-03de-4cad-9a7e-996252958766","subtype":"command","commandType":"auto","position":1.9765625,"command":"/*\nCreate a dataframe to store your results\nSchema: 3 columns, named: 'v', 'd', 'c' where:\n'v' : vertex id\n'd' : degree calculation (an integer value.  one row with highest in-degree, a row w/ highest out-degree, a row w/ highest total degree )\n'c' : category of degree, containing one of three string values:\n                                                'i' : in-degree\n                                                'o' : out-degree                                                \n                                                't' : total-degree\n- Your output should contain exactly three rows.  \n- Your output should contain exactly the column order specified.\n- The order of rows does not matter.\n                                                \nA correct output would be:\n\nv,d,c\n2,3,i\n1,3,o\n2,6,t\n\n\nwhereas:\n- Node 1 has highest in-degree with a value of 3\n- Node 2 has highest out-degree with a value of 3\n- Node 2 has highest total degree with a value of 6\n*/","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1538639011651,"submitTime":1538639007710,"finishTime":1538639011762,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"matthewhull@gatech.edu","latestUserId":"8931426928977113","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"76b3ab02-8cb9-48b5-9524-a593e2cd264d"},{"version":"CommandV1","origId":1299585061269613,"guid":"6cedd985-0ad8-4d21-b6b2-a2bb8a74594d","subtype":"command","commandType":"auto","position":2.9765625,"command":"display(df)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["1","2","5"],["1","3","5"],["1","4","5"],["2","1","5"],["2","3","5"],["2","5","5"],["3","4","5"],["4","2","5"],["4","5","5"],["4","6","5"],["5","2","5"],["1","2","5"],["3","1","4"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"Source","type":"\"string\"","metadata":"{}"},{"name":"Target","type":"\"string\"","metadata":"{}"},{"name":"Weight","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1538639011767,"submitTime":1538639007712,"finishTime":1538639012157,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"matthewhull@gatech.edu","latestUserId":"8931426928977113","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6734d102-8d5a-4038-9b80-1f5dac497889"}],"dashboards":[],"guid":"cc774475-ec86-43b4-9aff-21f1b4c97edf","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}